# ğŸ›’ Loja Web em Go (MVC)

AplicaÃ§Ã£o Web desenvolvida durante o curso de Go da Alura, focada no desenvolvimento web, manipulaÃ§Ã£o de banco de dados e arquitetura MVC. O projeto consiste em um sistema de gerenciamento de produtos (CRUD) com interface grÃ¡fica renderizada pelo servidor.

## ğŸš€ Funcionalidades

O sistema permite realizar as 4 operaÃ§Ãµes fundamentais em um banco de dados:

  * **Listar Produtos:** Exibe uma tabela com todos os produtos cadastrados.
  * **Adicionar Produto:** FormulÃ¡rio para inserÃ§Ã£o de novos itens.
  * **Editar Produto:** Carrega os dados de um produto existente para atualizaÃ§Ã£o.
  * **Deletar Produto:** Remove um produto do banco (com confirmaÃ§Ã£o via JavaScript).

## ğŸ› ï¸ Tecnologias Utilizadas

  * **Linguagem:** Go (Golang)
  * **Banco de Dados:** PostgreSQL
  * **Driver:** `github.com/lib/pq`
  * **Front-end:** HTML5, CSS3 (Bootstrap 4), JavaScript (Simples)
  * **Template Engine:** `html/template` (Nativo do Go)

## ğŸ—ï¸ Arquitetura do Projeto

O projeto segue o padrÃ£o **MVC (Model-View-Controller)** para separar as responsabilidades:

[Image of MVC architecture diagram web application]

  * **`/controllers`**: Gerencia as requisiÃ§Ãµes HTTP, chama os modelos e define qual template exibir.
  * **`/models`**: ContÃ©m a lÃ³gica de acesso ao banco de dados e as structs dos dados.
  * **`/templates` (Views)**: Arquivos HTML que sÃ£o renderizados com os dados dinÃ¢micos.
  * **`/db`**: ResponsÃ¡vel pela conexÃ£o com o banco de dados.
  * **`/routes`**: Define as rotas da aplicaÃ§Ã£o (endpoints).

-----

## ğŸ§  Aprofundamento TÃ©cnico

Pontos importantes sobre a implementaÃ§Ã£o e decisÃµes de cÃ³digo:

### 1\. ConexÃ£o Segura com Banco (Prepared Statements)

Para evitar ataques de **SQL Injection**, nÃ£o concatenamos strings diretamente nas queries. Utilizamos `Prepared Statements` (o `$1, $2` nas queries).

```go
// âŒ Ruim (VulnerÃ¡vel):
// db.Query("insert into produtos values (" + nome + ")")

// âœ… Bom (Seguro):
stmt, err := db.Prepare("insert into produtos(nome) values($1)")
stmt.Exec(nome)
```

Isso garante que o driver do Postgres trate os dados antes de executar o comando.

### 2\. Gerenciamento de Recursos (Defer)

Em Go, Ã© crucial fechar conexÃµes de banco de dados para nÃ£o vazar memÃ³ria ou estourar o limite de conexÃµes do servidor. Utilizamos a keyword `defer` para garantir que a conexÃ£o feche assim que a funÃ§Ã£o terminar, independentemente se houve erro ou sucesso.

```go
database := db.ConnectDatabase()
defer database.Close() // Executa por Ãºltimo, garantindo a limpeza
```

### 3\. Server-Side Rendering (SSR)

Diferente de Single Page Applications (React/Vue) que recebem JSON, aqui o Go processa o HTML no servidor e devolve a pÃ¡gina pronta.

  * **`template.ParseGlob`**: Carrega todos os arquivos `.html` na memÃ³ria na inicializaÃ§Ã£o (performance).
  * **`{{range .}}`**: FunÃ§Ã£o do template engine do Go para iterar sobre o Slice de produtos diretamente no HTML.

### 4\. ConversÃ£o de Tipos

Como o HTML envia tudo como `string`, a camada de **Controller** atua como um tradutor, convertendo os inputs para `float64` (preÃ§o) e `int` (quantidade) antes de passar para o **Model**. Isso garante a integridade dos dados antes de chegarem ao banco.

## âš™ï¸ ConfiguraÃ§Ã£o do Ambiente

### 1\. PrÃ©-requisitos

Certifique-se de ter instalado:

  * [Go](https://go.dev/dl/) (VersÃ£o 1.18+)
  * [PostgreSQL](https://www.postgresql.org/download/)

### 2\. ConfiguraÃ§Ã£o do Banco de Dados

O projeto estÃ¡ configurado para conectar em um banco local. Execute os comandos SQL abaixo no seu cliente Postgres (PgAdmin, DBeaver ou Terminal) para criar o banco e a tabela necessÃ¡ria:

```sql
-- 1. Criar o banco de dados
CREATE DATABASE alura_loja;

-- 2. Conectar ao banco
\c alura_loja;

-- 3. Criar a tabela de produtos
CREATE TABLE produtos (
    id serial primary key,
    nome varchar(255),
    descricao varchar(255),
    preco decimal,
    quantidade integer
);

-- 4. (Opcional) Inserir dados iniciais
INSERT INTO produtos (nome, descricao, preco, quantidade) VALUES
('Camiseta', 'Camiseta de algodÃ£o', 39.90, 10),
('Notebook', 'Notebook i7', 4500.00, 5);
```

> **Nota:** As credenciais de acesso ao banco estÃ£o definidas em `db/db.go`. Caso sua senha ou usuÃ¡rio sejam diferentes de `postgres/123`, altere a string de conexÃ£o neste arquivo.

### 3\. InstalaÃ§Ã£o e ExecuÃ§Ã£o

Clone o repositÃ³rio e navegue atÃ© a pasta do projeto:

```bash
# Baixar as dependÃªncias (Driver do Postgres)
go mod tidy

# Rodar o servidor
go run main.go
```

ApÃ³s iniciar, acesse no seu navegador:
ğŸ‘‰ **http://localhost:8000**

## ğŸ›£ï¸ Rotas da AplicaÃ§Ã£o

| MÃ©todo | Rota | DescriÃ§Ã£o |
| :--- | :--- | :--- |
| `GET` | `/` | PÃ¡gina inicial (Lista de produtos) |
| `GET` | `/new` | FormulÃ¡rio para criar novo produto |
| `POST` | `/insert` | AÃ§Ã£o que salva o novo produto no banco |
| `GET` | `/delete?id=X` | Remove o produto de ID X |
| `GET` | `/edit?id=X` | FormulÃ¡rio de ediÃ§Ã£o preenchido |
| `POST` | `/update` | AÃ§Ã£o que atualiza o produto no banco |

## ğŸ“¦ Estrutura de Pastas

```bash
03-Web/
â”œâ”€â”€ controllers/   # LÃ³gica de controle (handlers)
â”œâ”€â”€ db/            # ConexÃ£o com PostgreSQL
â”œâ”€â”€ models/        # Structs e Queries SQL
â”œâ”€â”€ routes/        # DefiniÃ§Ã£o de endpoints
â”œâ”€â”€ templates/     # Arquivos HTML (Index, New, Edit)
â”œâ”€â”€ main.go        # Ponto de entrada do servidor
â”œâ”€â”€ go.mod         # Gerenciador de dependÃªncias
â””â”€â”€ README.MD      # DocumentaÃ§Ã£o
```

-----

Desenvolvido como parte dos estudos em Go. ğŸ¹